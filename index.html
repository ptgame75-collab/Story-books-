<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Prank Ultimate</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root {
            --red: #e74c3c; --green: #2ecc71; --yellow: #f1c40f; --blue: #3498db;
            --board-bg: #e5c29f;
        }
        body { 
            margin: 0; padding: 0; 
            background: url('https://www.transparenttextures.com/patterns/wood-pattern.png'), #d2b48c;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
            font-family: 'Arial', sans-serif;
        }

        .game-wrapper { margin-top: 20px; position: relative; padding: 40px; }

        /* Ludo Board */
        .ludo-board {
            display: grid; grid-template-columns: repeat(15, 1fr); grid-template-rows: repeat(15, 1fr);
            width: 90vw; max-width: 450px; height: 90vw; max-height: 450px;
            background: white; border: 5px solid #5d4037; box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .cell { border: 0.1px solid #ccc; position: relative; }
        .base { grid-column: span 6; grid-row: span 6; border: 1px solid #000; }
        .red { background: var(--red); } .green { background: var(--green); }
        .blue { background: var(--blue); } .yellow { background: var(--yellow); }
        .center { grid-column: 7/10; grid-row: 7/10; background: #ddd; border: 1px solid #000; }

        /* Individual Dice Boxes near Bases */
        .dice-trigger {
            position: absolute; width: 50px; height: 50px;
            background: white; border: 3px solid #333; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); transition: 0.2s;
            z-index: 100; opacity: 0.3; pointer-events: none;
        }

        /* Active Dice Styling */
        .active-dice { opacity: 1; pointer-events: auto; border-color: gold; transform: scale(1.1); box-shadow: 0 0 15px gold; }

        /* Positioning Dice */
        #dice-red { top: -10px; left: -10px; }
        #dice-green { top: -10px; right: -10px; }
        #dice-blue { bottom: -10px; left: -10px; }
        #dice-yellow { bottom: -10px; right: -10px; }

        .rolling { animation: shake 0.2s infinite; }
        @keyframes shake { 0% {transform:rotate(0)} 50% {transform:rotate(10deg)} 100% {transform:rotate(-10deg)} }

        #status-bar { margin-top: 25px; padding: 10px 20px; background: rgba(0,0,0,0.7); color: white; border-radius: 30px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <div id="dice-red" class="dice-trigger" onclick="roll('red')">?</div>
        <div id="dice-green" class="dice-trigger active-dice" onclick="roll('green')">?</div>
        <div id="dice-blue" class="dice-trigger" onclick="roll('blue')">?</div>
        <div id="dice-yellow" class="dice-trigger" onclick="roll('yellow')">?</div>

        <div class="ludo-board" id="main-board">
            <div class="base red"></div>
            <div class="cell" style="grid-column: 7/10; grid-row: 1/7"></div> <div class="base green"></div>
            <div class="cell" style="grid-column: 1/7; grid-row: 7/10"></div>
            <div class="center"></div>
            <div class="cell" style="grid-column: 10/16; grid-row: 7/10"></div>
            <div class="base blue"></div>
            <div class="cell" style="grid-column: 7/10; grid-row: 10/16"></div>
            <div class="base yellow"></div>
        </div>
    </div>

    <div id="status-bar">पालो: <span id="current-p">GREEN</span></div>

    <script>
        let turn = 'green';
        let seq = [6, 6, 1, 6]; 
        let sIdx = 0;
        let canPlay = true;

        const diceMap = {
            red: document.getElementById('dice-red'),
            green: document.getElementById('dice-green'),
            blue: document.getElementById('dice-blue'),
            yellow: document.getElementById('dice-yellow')
        };

        function roll(color) {
            if (!canPlay || turn !== color) return;

            const dice = diceMap[color];
            dice.classList.add('rolling');
            canPlay = false;

            setTimeout(() => {
                dice.classList.remove('rolling');
                let res;

                // Prank logic for green
                if (turn === 'green' && sIdx < seq.length) {
                    res = seq[sIdx];
                    sIdx++;
                } else {
                    res = Math.floor(Math.random() * 6) + 1;
                }

                dice.innerText = res;

                // Rule: If 6 or 1, same player again
                if (res === 6 || res === 1) {
                    canPlay = true;
                } else {
                    setTimeout(nextTurn, 800);
                }
            }, 600);
        }

        function nextTurn() {
            const players = ['green', 'red', 'blue', 'yellow'];
            let idx = (players.indexOf(turn) + 1) % 4;
            
            // Deactivate current dice
            diceMap[turn].classList.remove('active-dice');
            diceMap[turn].innerText = "?";

            turn = players[idx];
            sIdx = 0; // Reset prank for next cycle

            // Activate next dice
            diceMap[turn].classList.add('active-dice');
            document.getElementById('current-p').innerText = turn.toUpperCase();
            document.getElementById('current-p').style.color = `var(--${turn})`;
            canPlay = true;
        }
    </script>
</body>
</html>
